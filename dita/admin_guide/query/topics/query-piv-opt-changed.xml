<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Composite//EN" "ditabase.dtd">

<topic id="topic1">
  <title>GPORCA带来的改变</title>
  <abstract>
    <shortdesc>相比使用传统规划器，启用了GPORCA优化器（默认启用）的Greenplum数据库的行为有些改变。</shortdesc>
  </abstract>
  <body>
    <ul id="ul_v1c_kll_gr">
      <li>允许在分布键上的<cmdname>UPDATE</cmdname>操作。</li>
      <li>允许在分区键上的<cmdname>UPDATE</cmdname>操作。</li>
      <li>支持对均衡分区表的查询。</li>
      <li>被修改为使用外部表作为叶子子分区的分区表上的查询会退回到传统查询优化器处理。</li>
      <li>Except for <codeph>INSERT</codeph>, DML operations directly on partition (child table) of
        a partitioned table are not supported.<p>For the <codeph>INSERT</codeph> command, you can
          specify a leaf child table of the partitioned table to insert data into a partitioned
          table. An error is returned if the data is not valid for the specified leaf child table.
          Specifying a child table that is not a leaf child table is not supported. </p></li>
      <li>The command <cmdname>CREATE TABLE AS</cmdname> distributes table data randomly if the
          <cmdname>DISTRIBUTED BY</cmdname> clause is not specified and no primary or unique keys
        are specified.</li>
      <li>Non-deterministic updates not allowed. The following <cmdname>UPDATE</cmdname> command
        returns an
        error.<codeblock>update r set b =  r.b  + 1 from s where  r.a  in (select a from s);</codeblock></li>
      <li>Statistics are required on the root table of a partitioned table. The
          <cmdname>ANALYZE</cmdname> command generates statistics on both root and individual
        partition tables (leaf child tables). See the <cmdname>ROOTPARTITION</cmdname> clause for
          <cmdname>ANALYZE</cmdname> command.</li>
      <li>Additional Result nodes in the query plan:<ul id="ul_h3c_gns_gr">
          <li>Query plan <cmdname>Assert</cmdname> operator.</li>
          <li>Query plan <cmdname>Partition selector</cmdname> operator.</li>
          <li>Query plan <cmdname>Split</cmdname> operator. </li>
        </ul></li>
      <li>When running <cmdname>EXPLAIN</cmdname>, the query plan generated by GPORCA is different than the plan generated by the Postgres query optimizer.</li>
      <li>Greenplum Database adds the log file message <codeph>Planner produced
        plan</codeph> when GPORCA is enabled and Greenplum Database falls back to the Postgres query optimizer to generate the query
        plan.</li>
      <li>Greenplum Database issues a warning when statistics are missing from one or
        more table columns. When executing an SQL command with GPORCA, Greenplum Database issues a warning if the command performance could be improved by
        collecting statistics on a column or set of columns referenced by the command. The warning
        is issued on the command line and information is added to the Greenplum Database log file. For information about collecting statistics on table columns, see the
          <cmdname>ANALYZE</cmdname> command in the <cite>Greenplum Database Reference
          Guide</cite>. </li>
    </ul>
  </body>
</topic>
